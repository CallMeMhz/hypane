<div x-data="posterPanel()" x-init="init()" class="h-full w-full">
  <template x-if="imageUrl">
    <a :href="linkUrl || '#'" :target="linkUrl ? '_blank' : '_self'" 
       class="block h-full w-full" :class="{ 'cursor-default': !linkUrl }">
      <img :src="imageUrl" :alt="alt" 
           class="h-full w-full rounded"
           :style="'object-fit: ' + fit">
    </a>
  </template>
  <template x-if="!imageUrl">
    <div class="h-full flex items-center justify-center text-gray-500 text-sm">
      未配置图片
    </div>
  </template>
</div>

<script>
window.posterPanel = window.posterPanel || function() {
  return {
    imageUrl: '',
    linkUrl: '',
    alt: '',
    fit: 'cover',
    panelId: '',
    
    async init() {
      this.panelId = this.$el.closest('[data-panel-id]').dataset.panelId;
      const res = await fetch('/api/panels/' + this.panelId + '/data');
      const data = await res.json();
      this.imageUrl = data.imageUrl || '';
      this.linkUrl = data.linkUrl || '';
      this.alt = data.alt || '';
      this.fit = data.fit || 'cover';
    }
  };
};
</script>
